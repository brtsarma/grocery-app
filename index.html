<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Grocery App PWA with Firebase</title>

<!-- Tailwind + Flowbite -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
<link rel="stylesheet" href="https://unpkg.com/flowbite@2.5.1/dist/flowbite.min.css">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#3b82f6">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="icon-192.png">

<!-- FULL GLASS UI THEME -->
<style>
:root {
  --glass-bg: rgba(255, 255, 255, 0.22);
  --glass-bg-strong: rgba(255, 255, 255, 0.32);
  --glass-border: rgba(255, 255, 255, 0.35);
  --glass-shadow: 0 8px 28px rgba(0,0,0,0.22);
  --glass-radius: 1.25rem;
}

body {
  background: linear-gradient(135deg, #dbeafe, #e0e7ff, #f5f3ff, #fce7f3);
  min-height: 100vh;
  backdrop-filter: blur(20px);
}

.checked {
  text-decoration: line-through;
  opacity: 0.5;
  filter: blur(0.6px);
  transition: all 0.25s ease;
}

/* Store/Recipe Glass Cards */
.store-card {
  min-width: 100%;
  padding: 1.5rem;
  border-radius: var(--glass-radius);
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.25), rgba(147, 51, 234, 0.1));
  backdrop-filter: blur(18px);
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);
  transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}
.store-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}
.store-card:hover::before {
  left: 100%;
}
.store-card:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 16px 40px rgba(147, 51, 234, 0.25);
}

/* Slider */
.slider-container {
  overflow: hidden;
  width: 100%;
  position: relative;
  background: var(--glass-bg-strong);
  border-radius: var(--glass-radius);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(25px);
  box-shadow: inset 0 0 20px rgba(255,255,255,0.25);
}

.slider-track {
  display: flex;
  transition: transform 0.45s cubic-bezier(0.22,1,0.36,1);
}

/* Input Fields */
input[type="text"], input[type="password"] {
  background: rgba(255,255,255,0.25);
  border: 1px solid var(--glass-border);
  border-radius: 0.9rem;
  padding: 0.75rem 1rem;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
  font-size: 0.95rem;
}
input[type="text"]:focus, input[type="password"]:focus {
  outline: none;
  border-color: rgba(59, 130, 246, 0.5);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 4px 16px rgba(0,0,0,0.12);
  background: rgba(255,255,255,0.35);
}

/* Buttons */
button {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(147, 51, 234, 0.3));
  border: 1px solid var(--glass-border);
  border-radius: 9999px;
  padding: 0.65rem 1.4rem;
  backdrop-filter: blur(14px);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 16px rgba(0,0,0,0.15);
  font-weight: 600;
  position: relative;
  overflow: hidden;
  letter-spacing: 0.025em;
  font-size: 0.875rem;
  text-transform: uppercase;
}
button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}
button:hover::before {
  width: 300px;
  height: 300px;
}
button:hover {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.4), rgba(147, 51, 234, 0.4));
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(59, 130, 246, 0.35);
}
button:active {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.6), rgba(37, 99, 235, 0.7));
  transform: translateY(0px) scale(0.96);
  box-shadow: 0 2px 12px rgba(59, 130, 246, 0.45);
}

/* Header Glass Style */
h1 {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(147, 51, 234, 0.3));
  padding: 0.8rem 1.5rem;
  border-radius: 1rem;
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);
  backdrop-filter: blur(15px);
  color: #1e293b;
  font-weight: 700;
  letter-spacing: -0.025em;
  position: relative;
  overflow: hidden;
}
h1::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, #3b82f6, #9333ea);
}

/* Login Box Override */
.bg-white\/90 {
  background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(147, 51, 234, 0.15)) !important;
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(20px);
  border-radius: 1.25rem;
  box-shadow: var(--glass-shadow);
}

/* Custom Checkbox Styling */
input[type="checkbox"] {
  appearance: none;
  width: 1.25rem;
  height: 1.25rem;
  border: 2px solid rgba(59, 130, 246, 0.5);
  border-radius: 0.375rem;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(8px);
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
}
input[type="checkbox"]:checked {
  background: linear-gradient(135deg, #3b82f6, #9333ea);
  border-color: #3b82f6;
}
input[type="checkbox"]:checked::after {
  content: '✓';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: white;
  font-weight: bold;
  font-size: 0.875rem;
}
input[type="checkbox"]:hover {
  border-color: rgba(59, 130, 246, 0.7);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* List Item Styling */
li {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 0.75rem;
  padding: 0.75rem 1rem;
  margin-bottom: 0.5rem;
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  cursor: move;
  user-select: none;
  position: relative;
}
li:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}
li.dragging {
  opacity: 0.5;
  transform: rotate(2deg);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  z-index: 1000;
}
li.drag-over {
  background: rgba(59, 130, 246, 0.2);
  border-color: rgba(59, 130, 246, 0.5);
  transform: translateY(2px);
}

/* Delete Button Styling */
button[onclick*="deleteItem"] {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(220, 38, 38, 0.3));
  padding: 0.4rem 0.6rem;
  font-size: 0.75rem;
  min-width: auto;
}
button[onclick*="deleteItem"]:hover {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.5), rgba(220, 38, 38, 0.5));
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}
button[onclick*="deleteItem"]:active {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.7), rgba(185, 28, 28, 0.7));
}
</style>

<!-- Firebase Imports -->
<script type="module">
  import { groceryRef, set, onValue } from "./firebase.js";
  window.firebaseRefs = { groceryRef, set, onValue };
</script>

<!-- React -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

</head>
<body>

<div id="root"></div>

<script type="text/babel">

/***********************
 * MAIN GROCERY APP
 ***********************/
function GroceryApp() {
  const { groceryRef, set, onValue } = window.firebaseRefs;

  /* Default Stores */
  const defaultStoreData = {
    Winco: ["Seeds","Nuts"],
    Walmart: ["Strawberry","Blueberry","Cilantro","Bell pepper","Cucumber","Organic spinach","Iceberg cabbage","Tomatoes","Avocados","Onion","Potatoes","Garlic","Cherry tomatoes","Banana","Chicken Breast","Organic mozzarella cheese sticks","Baby Bel","Tea milk","Probiotic Yogurt","Taco Fire Sauce","Salad dressing"],
    Sams: ["Protein bar","Once upon a Farm Pouch","Salmon","Wipes","Diaper","Cottage cheese","Lance Peanut biscuit","Cauliflower","Mushroom","Capsicum","Asparagus","Iceberg cabbage","Tea Milk","Organic Milk","Organic Egg"],
    Costco: ["Fish","Aussie Bites"],
    IndiaBazar: ["Dhaniya","Thorai Packet"]
  };

  /* Recipes */
  const defaultRecipeData = {
    Smoothie: ["Banana","Strawberry","Blueberry","Probiotic Yogurt"],
    "Green Salad": ["Organic spinach","Iceberg cabbage","Cucumber","Tomatoes","Cherry tomatoes","Bell pepper","Avocados","Onion","Salad dressing"],
    Tacos: ["Chicken Breast","Taco Fire Sauce","Cilantro","Onion"],
    "Kids Snacks": ["Seeds","Nuts","Organic mozzarella cheese sticks","Baby Bel","Once upon a Farm Pouch","Protein bar","Lance Peanut biscuit"],
    "Indian Curry": ["Dhaniya","Tomatoes","Onion","Garlic","Potatoes"]
  };

  /* React State */
  const [storeData, setStoreData] = React.useState({});
  const [recipeData, setRecipeData] = React.useState({});
  const [masterStoreData, setMasterStoreData] = React.useState({});
  const [masterRecipeData, setMasterRecipeData] = React.useState({});
  const [originalStoreOrder, setOriginalStoreOrder] = React.useState({});
  const [originalRecipeOrder, setOriginalRecipeOrder] = React.useState({});
  const [newItemText, setNewItemText] = React.useState({});
  const [newStoreName, setNewStoreName] = React.useState("");
  const [newRecipeName, setNewRecipeName] = React.useState("");
  const [currentIndex, setCurrentIndex] = React.useState(0);
  const [viewMode, setViewMode] = React.useState("store");
  const [touchStartX, setTouchStartX] = React.useState(null);
  const [touchEndX, setTouchEndX] = React.useState(null);
  const [isLoggedIn, setIsLoggedIn] = React.useState(false);
  const [loginForm, setLoginForm] = React.useState({ username: "", password: "" });
  const [loginError, setLoginError] = React.useState("");
  const [draggedItem, setDraggedItem] = React.useState(null);
  const [draggedOverGroup, setDraggedOverGroup] = React.useState(null);

  /**********************
   * Firebase Sync
   **********************/
  React.useEffect(() => {
    if (localStorage.getItem("groceryLoggedIn") === "1") {
      setIsLoggedIn(true);
    }

    onValue(groceryRef, snapshot => {
      const val = snapshot.val() || {};
      const rawStores = val.stores || {};
      const rawRecipes = val.recipes || {};

      const allStoreNames = [...new Set([...Object.keys(defaultStoreData), ...Object.keys(rawStores)])];
      const allRecipeNames = [...new Set([...Object.keys(defaultRecipeData), ...Object.keys(rawRecipes)])];

      const loadedStores = {};
      allStoreNames.forEach(store => {
        const source = rawStores[store] || defaultStoreData[store] || [];
        loadedStores[store] = source.map(x => (typeof x === "string" ? { name: x, checked: false } : x));
      });

      const loadedRecipes = {};
      allRecipeNames.forEach(recipe => {
        const source = rawRecipes[recipe] || defaultRecipeData[recipe] || [];
        loadedRecipes[recipe] = source.map(x => (typeof x === "string" ? { name: x, checked: false } : x));
      });

      setStoreData(loadedStores);
      setMasterStoreData(loadedStores);
      setOriginalStoreOrder(JSON.parse(JSON.stringify(loadedStores)));

      setRecipeData(loadedRecipes);
      setMasterRecipeData(loadedRecipes);
      setOriginalRecipeOrder(JSON.parse(JSON.stringify(loadedRecipes)));

      set(groceryRef, { stores: loadedStores, recipes: loadedRecipes });
    });
  }, []);

  /**********************
   * Save to Firebase
   **********************/
  const saveToFirebase = (stores, recipes) => {
    set(groceryRef, {
      stores: stores || storeData,
      recipes: recipes || recipeData
    });
  };

  /**********************
   * Check Item
   **********************/
  const handleCheck = (name) => {
    const newStores = JSON.parse(JSON.stringify(storeData));
    const newRecipes = JSON.parse(JSON.stringify(recipeData));

    let checked = false;

    Object.values(newStores).forEach(list => list.forEach(i => { if (i.name === name && i.checked) checked = true; }));
    Object.values(newRecipes).forEach(list => list.forEach(i => { if (i.name === name && i.checked) checked = true; }));

    const newVal = !checked;

    Object.keys(newStores).forEach(s => {
      newStores[s] = newStores[s].map(it => it.name === name ? { ...it, checked: newVal } : it);
      // Sort items: unchecked first, then checked
      newStores[s] = [...newStores[s].filter(item => !item.checked), ...newStores[s].filter(item => item.checked)];
    });
    Object.keys(newRecipes).forEach(r => {
      newRecipes[r] = newRecipes[r].map(it => it.name === name ? { ...it, checked: newVal } : it);
      // Sort items: unchecked first, then checked
      newRecipes[r] = [...newRecipes[r].filter(item => !item.checked), ...newRecipes[r].filter(item => item.checked)];
    });

    setStoreData(newStores);
    setRecipeData(newRecipes);
    saveToFirebase(newStores, newRecipes);
  };

  /**********************
   * Add Item
   **********************/
  const addItem = (group, text) => {
    if (!text) return;

    const newItems = text.split(",").map(i => i.trim()).filter(x => x).map(x => ({ name: x, checked: false }));

    if (viewMode === "store") {
      const updatedStores = { ...storeData, [group]: [...storeData[group], ...newItems] };
      setStoreData(updatedStores);
      setMasterStoreData({ ...masterStoreData, [group]: [...masterStoreData[group], ...newItems] });
      saveToFirebase(updatedStores, null);
    } else {
      const updatedRecipes = { ...recipeData, [group]: [...recipeData[group], ...newItems] };
      setRecipeData(updatedRecipes);
      setMasterRecipeData({ ...masterRecipeData, [group]: [...masterRecipeData[group], ...newItems] });
      saveToFirebase(null, updatedRecipes);
    }

    setNewItemText(prev => ({ ...prev, [group]: "" }));
  };

  /**********************
   * Delete Item
   **********************/
  const deleteItem = (name) => {
    const updatedStores = {};
    const updatedRecipes = {};

    Object.keys(storeData).forEach(s => {
      updatedStores[s] = storeData[s].filter(i => i.name !== name);
    });
    Object.keys(recipeData).forEach(r => {
      updatedRecipes[r] = recipeData[r].filter(i => i.name !== name);
    });

    setStoreData(updatedStores);
    setRecipeData(updatedRecipes);
    saveToFirebase(updatedStores, updatedRecipes);
  };

  /**********************
   * Reset List
   **********************/
  const resetList = () => {
    const newStores = {};
    Object.keys(originalStoreOrder).forEach(s => {
      // Reset to original order and uncheck all items
      newStores[s] = originalStoreOrder[s].map(i => ({ ...i, checked: false }));
    });

    const newRecipes = {};
    Object.keys(originalRecipeOrder).forEach(r => {
      // Reset to original order and uncheck all items
      newRecipes[r] = originalRecipeOrder[r].map(i => ({ ...i, checked: false }));
    });

    setStoreData(newStores);
    setRecipeData(newRecipes);
    saveToFirebase(newStores, newRecipes);
  };

  /**********************
   * Add Store / Recipe
   **********************/
  const addStore = () => {
    if (!newStoreName.trim()) return;
    if (storeData[newStoreName]) return;

    const updatedStores = { ...storeData, [newStoreName]: [] };
    setStoreData(updatedStores);
    setMasterStoreData({ ...masterStoreData, [newStoreName]: [] });
    setNewStoreName("");
    setCurrentIndex(Object.keys(updatedStores).length - 1);
    saveToFirebase(updatedStores, null);
  };

  const addRecipeGroup = () => {
    if (!newRecipeName.trim()) return;
    if (recipeData[newRecipeName]) return;

    const updatedRecipes = { ...recipeData, [newRecipeName]: [] };
    setRecipeData(updatedRecipes);
    setMasterRecipeData({ ...masterRecipeData, [newRecipeName]: [] });
    setNewRecipeName("");
    setCurrentIndex(Object.keys(updatedRecipes).length - 1);
    saveToFirebase(null, updatedRecipes);
  };

  /**********************
   * Swipe Logic (Loop)
   **********************/
  const activeList = viewMode === "store" ? storeData : recipeData;
  const names = Object.keys(activeList);

  const nextGroup = () =>
    setCurrentIndex(i => (i + 1) % names.length);

  const prevGroup = () =>
    setCurrentIndex(i => (i - 1 + names.length) % names.length);

  const handleTouchStart = (e) => {
    setTouchStartX(e.touches[0].clientX);
    setTouchEndX(null);
  };

  const handleTouchMove = (e) => {
    setTouchEndX(e.touches[0].clientX);
  };

  const handleTouchEnd = () => {
    if (touchStartX == null || touchEndX == null) return;

    const diff = touchStartX - touchEndX;

    if (diff > 50) nextGroup();
    if (diff < -50) prevGroup();

    setTouchStartX(null);
    setTouchEndX(null);
  };

  /**********************
   * Login Logic
   **********************/
  const loginSubmit = (e) => {
    e.preventDefault();
    if (loginForm.username === "admin" && loginForm.password === "grocery123") {
      setIsLoggedIn(true);
      localStorage.setItem("groceryLoggedIn", "1");
    } else {
      setLoginError("Invalid username or password.");
    }
  };

  const logout = () => {
    setIsLoggedIn(false);
    localStorage.removeItem("groceryLoggedIn");
  };

  /**********************
   * Drag and Drop Functions
   **********************/
  const handleDragStart = (e, item, groupName) => {
    setDraggedItem({ item, groupName });
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', e.target.innerHTML);
  };

  const handleDragOver = (e) => {
    e.preventDefault();
    e.dataTransfer.dropEffect = 'move';
  };

  const handleDragEnter = (e, groupName) => {
    e.preventDefault();
    setDraggedOverGroup(groupName);
  };

  const handleDragLeave = () => {
    setDraggedOverGroup(null);
  };

  const handleDrop = (e, targetGroupName, targetIndex) => {
    e.preventDefault();
    setDraggedOverGroup(null);
    
    if (!draggedItem) return;
    
    const { item: draggedItemData, groupName: sourceGroupName } = draggedItem;
    
    if (viewMode === "store") {
      const newStores = JSON.parse(JSON.stringify(storeData));
      const sourceList = [...newStores[sourceGroupName]];
      const targetList = sourceGroupName === targetGroupName ? sourceList : [...newStores[targetGroupName]];
      
      // Remove from source
      const draggedIndex = sourceList.findIndex(i => i.name === draggedItemData.name);
      if (draggedIndex === -1) return;
      
      const [removed] = sourceList.splice(draggedIndex, 1);
      
      // Add to target
      if (sourceGroupName === targetGroupName) {
        sourceList.splice(targetIndex, 0, removed);
        newStores[sourceGroupName] = sourceList;
      } else {
        targetList.splice(targetIndex, 0, removed);
        newStores[sourceGroupName] = sourceList;
        newStores[targetGroupName] = targetList;
      }
      
      setStoreData(newStores);
      saveToFirebase(newStores, null);
    } else {
      const newRecipes = JSON.parse(JSON.stringify(recipeData));
      const sourceList = [...newRecipes[sourceGroupName]];
      const targetList = sourceGroupName === targetGroupName ? sourceList : [...newRecipes[targetGroupName]];
      
      // Remove from source
      const draggedIndex = sourceList.findIndex(i => i.name === draggedItemData.name);
      if (draggedIndex === -1) return;
      
      const [removed] = sourceList.splice(draggedIndex, 1);
      
      // Add to target
      if (sourceGroupName === targetGroupName) {
        sourceList.splice(targetIndex, 0, removed);
        newRecipes[sourceGroupName] = sourceList;
      } else {
        targetList.splice(targetIndex, 0, removed);
        newRecipes[sourceGroupName] = sourceList;
        newRecipes[targetGroupName] = targetList;
      }
      
      setRecipeData(newRecipes);
      saveToFirebase(null, newRecipes);
    }
    
    setDraggedItem(null);
  };

  const handleDragEnd = () => {
    setDraggedItem(null);
    setDraggedOverGroup(null);
  };

  /**********************
   * LOGIN PAGE
   **********************/
  if (!isLoggedIn) {
    return (
      <div className="min-h-screen flex items-center justify-center px-4">
        <div className="bg-white/90 shadow-xl p-6 max-w-sm w-full">
          <h1 className="text-2xl font-bold text-center mb-3">Grocery App</h1>

          {loginError && <p className="text-red-500 text-xs text-center mb-2">{loginError}</p>}

          <form onSubmit={loginSubmit} className="space-y-3">
            <input
              type="text"
              placeholder="Username"
              value={loginForm.username}
              onChange={e => setLoginForm({ ...loginForm, username: e.target.value })}
              className="w-full"
            />

            <input
              type="password"
              placeholder="Password"
              value={loginForm.password}
              onChange={e => setLoginForm({ ...loginForm, password: e.target.value })}
              className="w-full"
            />

            <button className="w-full">Login</button>
          </form>
        </div>
      </div>
    );
  }

  /**********************
   * MAIN UI
   **********************/
  return (
    <div className="max-w-xl mx-auto p-4">

      {/* Header */}
      <div className="flex justify-between items-center mb-5">
        <h1 className="text-3xl font-bold">Grocery List</h1>
        <button onClick={logout}>Logout</button>
      </div>

      {/* Toggle Buttons */}
      <div className="flex gap-2 mb-4 justify-center">
        <button onClick={() => { setViewMode("store"); setCurrentIndex(0); }}>
          Store-wise
        </button>
        <button onClick={() => { setViewMode("recipe"); setCurrentIndex(0); }}>
          Recipe-wise
        </button>
      </div>

      {/* Add Store / Recipe */}
      <div className="mb-4">
        {viewMode === "store" ? (
          <div className="bg-white/90 p-3 rounded-xl">
            <div>Add New Store</div>
            <div className="flex gap-2 mt-2">
              <input value={newStoreName} onChange={e => setNewStoreName(e.target.value)} placeholder="Store name" className="flex-1" />
              <button onClick={addStore}>Add</button>
            </div>
          </div>
        ) : (
          <div className="bg-white/90 p-3 rounded-xl">
            <div>Add New Recipe</div>
            <div className="flex gap-2 mt-2">
              <input value={newRecipeName} onChange={e => setNewRecipeName(e.target.value)} placeholder="Recipe name" className="flex-1" />
              <button onClick={addRecipeGroup}>Add</button>
            </div>
          </div>
        )}
      </div>

      {/* RESET BUTTON */}
      <button className="w-full mb-4" onClick={resetList}>
        Reset List
      </button>

      {/* SLIDER */}
      <div
        className="slider-container"
        onTouchStart={handleTouchStart}
        onTouchMove={handleTouchMove}
        onTouchEnd={handleTouchEnd}
      >
        <div
          className="slider-track"
          style={{ transform: `translateX(-${currentIndex * 100}%)` }}
        >
          {names.map(name => (
            <div key={name} className="store-card">
              <h2 className="text-xl font-semibold mb-2">{name}</h2>

              {/* Add items */}
              <div className="flex gap-2 mb-2 flex-wrap">
                <input
                  type="text"
                  placeholder="Add items"
                  value={newItemText[name] || ""}
                  onChange={e => setNewItemText(prev => ({ ...prev, [name]: e.target.value }))}
                  className="flex-1 min-w-[140px]"
                />
                <button onClick={() => addItem(name, newItemText[name])}>Add</button>
              </div>

              {/* Items */}
              <ul className="space-y-2">
                {activeList[name]?.map((item, index) => (
                  <li 
                    key={item.name} 
                    className={`flex justify-between items-center ${draggedOverGroup === name ? 'drag-over' : ''}`}
                    draggable
                    onDragStart={(e) => handleDragStart(e, item, name)}
                    onDragOver={handleDragOver}
                    onDragEnter={(e) => handleDragEnter(e, name)}
                    onDragLeave={handleDragLeave}
                    onDrop={(e) => handleDrop(e, name, index)}
                    onDragEnd={handleDragEnd}
                  >
                    <label className="flex items-center gap-2">
                      <input type="checkbox" checked={item.checked} onChange={() => handleCheck(item.name)} />
                      <span className={item.checked ? "checked" : ""}>{item.name}</span>
                    </label>
                    <button onClick={() => deleteItem(item.name)}>✕</button>
                  </li>
                ))}
              </ul>

            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<GroceryApp />);

</script>

</body>
</html>
